# 阿里云 RDS 数据库配置指南

## 🚀 创建阿里云数据库（详细步骤）

### 1. 注册/登录阿里云
- 访问：https://console.aliyun.com/
- 如果没有账号，先注册（手机号验证）

### 2. 进入 RDS 控制台
1. 点击左侧导航栏的"数据库"
2. 选择"云数据库 RDS"
3. 点击"创建实例"

### 3. 选择数据库类型
- **引擎选择**：PostgreSQL
- **版本选择**：PostgreSQL 16（最新稳定版）
- **系列选择**：MySQL 系列（共享型，最便宜）

### 4. 配置实例规格
- **实例规格**：共享型（1核2GB，入门级）
- **存储类型**：SSD 云盘
- **存储空间**：20GB（起步）
- **可用区**：选择你所在城市

### 5. 设置账号密码
- **管理员账号**：自定义（如 tianjige_user）
- **密码**：设置强密码（如 Tianjige@2024）
- **确认密码**：再次输入

### 6. 网络配置
- **网络类型**：专有网络
- **专有网络**：默认选择第一个
- **交换机**：默认选择
- **白名单设置**：
  - 点击"白名单设置"
  - 添加 IP：0.0.0.0/0（允许所有IP访问）
  - **生产环境建议只指定IP**

### 7. 初始化设置
- **数据库名**：tianjige
- **字符集**：UTF8
- **模板选择**：默认模板

### 8. 确认订单
- **实例命名**：tianjige-db
- **购买时长**：1个月
- **点击"确认下单"**

### 9. 等待实例创建
- 创建时间：约5-10分钟
- 状态显示"运行中"即可使用

## 🔧 连接配置

### 1. 获取连接信息
在 RDS 控制台：
1. 点击实例名称
2. 查看"数据库连接"区域
3. 记录：
   - **主地址**（Host）
   - **端口**（Port，默认5432）
   - **用户名**
   - **密码**
   - **数据库名**

### 2. 修改项目配置
```env
# .env.local
DATABASE_URL=postgresql://tianjige_user:Tianjige@2024@主地址:端口/tianjige
```

### 3. 创建数据库表
```bash
# 连接到阿里云数据库
psql -h 主地址 -p 端口 -U tianjige_user -d tianjige

# 复制表创建 SQL 并执行
```

## 💰 费用说明

### 1. 费用构成
- **基础费用**：约 50-100 元/月（共享型1核2GB）
- **存储费用**：约 1-2 元/GB/月（20GB约20-40元/月）
- **总计**：约 70-140 元/月

### 2. 节省建议
- **使用共享型**：性能足够开发测试
- **按需付费**：不用时可以删除
- **设置自动备份**：减少手动操作

## 🔒 安全设置

### 1. 修改白名单
- 不要长期使用 0.0.0.0/0
- 只允许你的 IP 访问：
  - 查看自己IP：https://ipinfo.io
  - 在 RDS 控制台添加你的 IP

### 2. 定期备份
- 在 RDS 控制台设置自动备份
- 保留7天备份历史

### 3. 监控设置
- 设置 CPU、内存使用率告警
- 设置连接数监控

## 🚨 注意事项

### 1. 免费额度
- 阿里云新用户通常有免费试用额度
- 查看"费用中心"的免费额度

### 2. 删除实例
- 删除后数据无法恢复
- 确认不再使用后再删除

### 3. 数据迁移
- 从本地迁移到云端：使用 pg_dump 导入
- 从云端迁移本地：反向操作

## 📱 移动开发提示

如果你需要在外开发：
1. **设置公网访问**（默认已开启）
2. **使用 4G/5G 网络**访问数据库
3. **考虑使用 VPN**（如果被限制）

## 🎯 总结

阿里云数据库是一个很好的选择，特别是：
- ✅ 团队协作开发
- ✅ 24/7 可用
- ✅ 自动备份
- ✅ 性能稳定

但对于个人开发，**本地按需启动**完全够用且免费！